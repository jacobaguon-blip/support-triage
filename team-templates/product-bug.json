{
  "team_name": "Product Bug Investigation Team",
  "classification": "product_bug",
  "description": "Specialized team for investigating platform issues (UI problems, API errors, workflow breakages, permissions issues)",
  "agents": [
    {
      "role": "product-code-reviewer",
      "description": "Find relevant platform code, trace errors to specific files/lines",
      "data_sources": [
        "~/C1/ductone/"
      ],
      "search_strategy": [
        "Use product area from ticket to identify relevant subdirectories",
        "Search for UI component names (for UI issues)",
        "Search for API endpoint patterns (for API issues)",
        "Search for workflow/state machine logic (for workflow issues)",
        "Search for RBAC logic (for permissions issues)",
        "Grep for error messages and stack traces",
        "Trace code paths from error location"
      ],
      "key_subdirectories": {
        "c1": "Core platform logic",
        "pkg": "Shared packages and libraries",
        "ops": "Operations and infrastructure",
        "thomas-browser-agent": "AI agent functionality"
      },
      "output_requirements": [
        "File paths with line ranges",
        "Code summaries for affected areas",
        "Error trace analysis (Level 2)",
        "Prompt for Level 3 analysis"
      ],
      "phase": 1
    },
    {
      "role": "issue-historian",
      "description": "Search Linear and Pylon for similar past issues, find related tickets and engineering work",
      "data_sources": [
        "Linear MCP",
        "Pylon MCP"
      ],
      "search_strategy": [
        "Search Linear with product area + error keywords",
        "Search Pylon for similar customer reports",
        "Filter by product area labels",
        "Identify patterns across similar issues",
        "Check status of related engineering work"
      ],
      "output_requirements": [
        "Linear issue links with status and relevance",
        "Pylon ticket references",
        "Pattern analysis across similar issues",
        "Timeline of related work"
      ],
      "phase": 1
    },
    {
      "role": "slack-context-researcher",
      "description": "Search Slack broadly for discussions about this customer, product area, or error pattern",
      "data_sources": [
        "Slack MCP (all channels)"
      ],
      "search_strategy": [
        "Search by customer name",
        "Search by product area",
        "Search by error message text",
        "Search for escalation discussions",
        "Focus on recent discussions (last 3-6 months)",
        "Prioritize channels with engineering participation"
      ],
      "output_requirements": [
        "Channel names and dates",
        "Thread summaries with context",
        "Links to relevant threads",
        "Pattern identification across discussions",
        "Note which channels had most relevant content"
      ],
      "phase": 1
    }
  ],
  "workflow": {
    "phase_1": {
      "name": "Parallel Context Gathering",
      "execution": "parallel",
      "agents": [
        "product-code-reviewer",
        "issue-historian",
        "slack-context-researcher"
      ],
      "checkpoint_after": "checkpoint_2_post_context_gathering",
      "output": "Individual findings from each specialist agent"
    },
    "phase_2": {
      "name": "Synthesis and Document Generation",
      "execution": "sequential",
      "lead_agent": true,
      "depends_on": ["phase_1"],
      "tasks": [
        "Collect findings from all specialist agents",
        "Identify patterns and connections across findings",
        "Generate complete investigation document (summary.md)",
        "Draft Linear issue (linear-draft.md)",
        "Draft customer response (customer-response.md)",
        "Update SQLite with findings metadata"
      ],
      "checkpoint_after": "checkpoint_3_investigation_validation",
      "output": "Complete investigation package"
    }
  },
  "checkpoints": [
    {
      "id": "checkpoint_1_post_classification",
      "trigger": "after_classification",
      "required_data": [
        "ticket_info",
        "classification_result",
        "classification_reasoning"
      ]
    },
    {
      "id": "checkpoint_2_post_context_gathering",
      "trigger": "after_phase_1",
      "required_data": [
        "code_findings",
        "history_findings",
        "slack_findings",
        "identified_gaps"
      ]
    },
    {
      "id": "checkpoint_3_investigation_validation",
      "trigger": "after_phase_2",
      "required_data": [
        "summary_document",
        "linear_draft",
        "customer_response_draft"
      ]
    },
    {
      "id": "checkpoint_4_solution_check",
      "trigger": "after_revisions",
      "required_data": [
        "revised_documents",
        "final_customer_response"
      ]
    }
  ],
  "expected_outputs": {
    "files": [
      "summary.md",
      "linear-draft.md",
      "customer-response.md",
      "agent-transcript.txt",
      "metrics.json"
    ],
    "database_updates": [
      "classification",
      "product_area",
      "status",
      "current_checkpoint",
      "output_path"
    ]
  },
  "product_area_mapping": {
    "Platform / UI": ["c1/", "pkg/ui/"],
    "Access Profiles": ["c1/access-profiles/"],
    "Access Requests": ["c1/access-requests/"],
    "Access Reviews": ["c1/access-reviews/"],
    "API / Terraform": ["c1/api/", "pkg/api/"],
    "Automations": ["c1/automations/"],
    "Notifications": ["c1/notifications/"],
    "Policies": ["c1/policies/"],
    "RBAC": ["c1/rbac/", "pkg/auth/"],
    "Thomas - AI Agent": ["thomas-browser-agent/"]
  },
  "safety_constraints": {
    "read_only_paths": [
      "~/C1/"
    ],
    "writable_paths": [
      "~/support-triage/investigations/{ticket-id}/"
    ],
    "forbidden_actions": [
      "modify_c1_code",
      "create_linear_issue",
      "send_pylon_message",
      "push_to_notion"
    ]
  }
}
